<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>Sulifa 1v1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-indigo-700 min-h-screen flex items-center justify-center text-white">

<div class="bg-white text-gray-800 rounded-xl p-6 w-80 text-center">

  <h1 class="text-xl font-bold mb-3">ğŸ® Sulifa 1v1</h1>

  <div id="status">Ğ”Ğ°Ğ¹Ñ‹Ğ½</div>

  <button onclick="start()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded">
    ĞĞ¹Ğ½Ğ°Ñƒ
  </button>

  <div id="choices" class="hidden mt-4 space-y-2">
    <button onclick="send('rock')" class="btn">ğŸª¨ Ğ¢Ğ°Ñ</button>
    <button onclick="send('paper')" class="btn">ğŸ“„ ÒšĞ°Ò“Ğ°Ğ·</button>
    <button onclick="send('scissors')" class="btn">âœ‚ï¸ ÒšĞ°Ğ¹ÑˆÑ‹</button>
  </div>

</div>

<script>
const tg = Telegram.WebApp;
tg.ready();

const tgId = String(tg.initDataUnsafe.user.id);
const socket = io("https://sulifaonlinerender.onrender.com");

function start() {
  socket.emit("join_game", tgId);
  document.getElementById("status").innerText = "â³ ĞšÒ¯Ñ‚Ñƒ...";
}

socket.on("waiting", () => {
  document.getElementById("status").innerText = "âŒ› ÒšĞ°Ñ€ÑÑ‹Ğ»Ğ°Ñ ĞºÒ¯Ñ‚Ñ–Ğ»ÑƒĞ´Ğµ...";
});

socket.on("game_start", () => {
  document.getElementById("status").innerText = "âœŠ Ğ¢Ğ°Ò£Ğ´Ğ°";
  document.getElementById("choices").classList.remove("hidden");
});

function send(choice) {
  document.getElementById("choices").classList.add("hidden");
  document.getElementById("status").innerText = "â³ ĞšÒ¯Ñ‚Ñƒ...";
  socket.emit("choice", choice);
}

socket.on("game_result", data => {
  let msg = "ğŸ¤ Ğ¢ĞµÒ£";
  if (data.winner === tgId) msg = "ğŸ† Ğ–ĞµÒ£Ğ´Ñ–Ò£!";
  else if (data.winner !== "draw") msg = "âŒ Ğ–ĞµÒ£Ñ–Ğ»Ğ´Ñ–Ò£";

  document.getElementById("status").innerText = msg;
});
</script>

<style>
.btn {
  background:#6366f1;
  color:white;
  width:100%;
  padding:10px;
  border-radius:10px;
}
</style>

</body>
</html>
